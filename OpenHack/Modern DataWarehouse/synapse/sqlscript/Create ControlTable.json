{
	"name": "Create ControlTable",
	"properties": {
		"folder": {
			"name": "Data Loading"
		},
		"content": {
			"query": "IF \n(\n    EXISTS \n    (\n        SELECT * \n        FROM INFORMATION_SCHEMA.TABLES \n        WHERE TABLE_SCHEMA = 'dbo' \n        AND  TABLE_NAME = 'ControlTable'\n    )\n)\nBEGIN\n    DROP TABLE [dbo].[ControlTable]\nEND\n\n/****** Object:  Table [dbo].[ControlTable] ******/\nCREATE TABLE [dbo].[ControlTable]\n(\n    [Id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY NONCLUSTERED NOT ENFORCED,\n    [SourceObjectSettings] [nvarchar](max) NULL,\n    [SourceConnectionSettingsName] [varchar](max) NULL,\n    [CopySourceSettings] [nvarchar](max) NULL,\n    [SinkObjectSettings] [nvarchar](max) NULL,\n    [SinkConnectionSettingsName] [varchar](max) NULL,\n    [CopySinkSettings] [nvarchar](max) NULL,\n    [CopyActivitySettings] [nvarchar](max) NULL,\n    [TopLevelPipelineName] [varchar](max) NULL,\n    [TriggerName] [nvarchar](max) NULL,\n    [DataLoadingBehaviorSettings] [nvarchar](max) NULL,\n    [TaskId] [int] NULL,\n    [CopyEnabled] [bit] NULL\n) WITH ( HEAP )\n\nDECLARE @MainControlMetadata NVARCHAR(max)  = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Addresses\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Addresses.parquet\",\n            \"folderPath\": \"CloudSales\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudSales_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\",\n            \"TriggerSourceSystemsToBronze\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Customers\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Customers.parquet\",\n            \"folderPath\": \"CloudSales\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudSales_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\",\n            \"TriggerSourceSystemsToBronze\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"OrderDetails\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_OrderDetails.parquet\",\n            \"folderPath\": \"CloudSales\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudSales_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\",\n            \"TriggerSourceSystemsToBronze\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Orders\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Orders.parquet\",\n            \"folderPath\": \"CloudSales\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudSales_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\",\n            \"TriggerSourceSystemsToBronze\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\nINSERT INTO [dbo].[ControlTable] \n(\n    [SourceObjectSettings],\n    [SourceConnectionSettingsName],\n    [CopySourceSettings],\n    [SinkObjectSettings],\n    [SinkConnectionSettingsName],\n    [CopySinkSettings],\n    [CopyActivitySettings],\n    [TopLevelPipelineName],\n    [TriggerName],\n    [DataLoadingBehaviorSettings],\n    [TaskId],\n    [CopyEnabled]\n)\nSELECT * \nFROM OPENJSON(@MainControlMetadata)\nWITH \n(\n    [SourceObjectSettings] [nvarchar](max) AS JSON,\n    [SourceConnectionSettingsName] [varchar](max),\n    [CopySourceSettings] [nvarchar](max) AS JSON,\n    [SinkObjectSettings] [nvarchar](max) AS JSON,\n    [SinkConnectionSettingsName] [varchar](max),\n    [CopySinkSettings] [nvarchar](max) AS JSON,\n    [CopyActivitySettings] [nvarchar](max) AS JSON,\n    [TopLevelPipelineName] [varchar](max),\n    [TriggerName] [nvarchar](max) AS JSON,\n    [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n    [TaskId] [int],\n    [CopyEnabled] [bit]\n)\n\nSET @MainControlMetadata = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Addresses\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Addresses.parquet\",\n            \"folderPath\": \"CloudStreaming\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudStreaming_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Customers\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Customers.parquet\",\n            \"folderPath\": \"CloudStreaming\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudStreaming_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Transactions\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Transactions.parquet\",\n            \"folderPath\": \"CloudStreaming\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_CloudStreaming_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\nINSERT INTO [dbo].[ControlTable] \n(\n    [SourceObjectSettings],\n    [SourceConnectionSettingsName],\n    [CopySourceSettings],\n    [SinkObjectSettings],\n    [SinkConnectionSettingsName],\n    [CopySinkSettings],\n    [CopyActivitySettings],\n    [TopLevelPipelineName],\n    [TriggerName],\n    [DataLoadingBehaviorSettings],\n    [TaskId],\n    [CopyEnabled]\n)\nSELECT * \nFROM OPENJSON(@MainControlMetadata)\nWITH \n(\n    [SourceObjectSettings] [nvarchar](max) AS JSON,\n    [SourceConnectionSettingsName] [varchar](max),\n    [CopySourceSettings] [nvarchar](max) AS JSON,\n    [SinkObjectSettings] [nvarchar](max) AS JSON,\n    [SinkConnectionSettingsName] [varchar](max),\n    [CopySinkSettings] [nvarchar](max) AS JSON,\n    [CopyActivitySettings] [nvarchar](max) AS JSON,\n    [TopLevelPipelineName] [varchar](max),\n    [TriggerName] [nvarchar](max) AS JSON,\n    [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n    [TaskId] [int],\n    [CopyEnabled] [bit]\n)\n\nSET @MainControlMetadata = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"collectionName\": \"movies\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"movies.json\",\n            \"folderPath\": \"Movies\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": {\n                \"type\": \"TabularTranslator\",\n                \"mappings\": [\n                    {\n                        \"source\": {\n                            \"path\": \"actors\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''actors'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''availabilityDate'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''availabilityDate'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''genre'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''genre'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''rating'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''rating'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''releaseYear'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''releaseYear'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''runtime'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''runtime'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''streamingAvailabilityDate'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''streamingAvailabilityDate'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''tier'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''tier'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''title'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''title'']\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"path\": \"$[''id'']\"\n                        },\n                        \"sink\": {\n                            \"path\": \"$[''id'']\"\n                        }\n                    }\n                ],\n                \"collectionReference\": \"\"\n            }\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_SouthridgeCatalog_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\n\nINSERT INTO [dbo].[ControlTable] \n(\n    [SourceObjectSettings],\n    [SourceConnectionSettingsName],\n    [CopySourceSettings],\n    [SinkObjectSettings],\n    [SinkConnectionSettingsName],\n    [CopySinkSettings],\n    [CopyActivitySettings],\n    [TopLevelPipelineName],\n    [TriggerName],\n    [DataLoadingBehaviorSettings],\n    [TaskId],\n    [CopyEnabled]\n)\nSELECT * \nFROM OPENJSON(@MainControlMetadata)\nWITH \n(\n    [SourceObjectSettings] [nvarchar](max) AS JSON,\n    [SourceConnectionSettingsName] [varchar](max),\n    [CopySourceSettings] [nvarchar](max) AS JSON,\n    [SinkObjectSettings] [nvarchar](max) AS JSON,\n    [SinkConnectionSettingsName] [varchar](max),\n    [CopySinkSettings] [nvarchar](max) AS JSON,\n    [CopyActivitySettings] [nvarchar](max) AS JSON,\n    [TopLevelPipelineName] [varchar](max),\n    [TriggerName] [nvarchar](max) AS JSON,\n    [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n    [TaskId] [int],\n    [CopyEnabled] [bit]\n)\n\nSET @MainControlMetadata = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Actors\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Actors.parquet\",\n            \"folderPath\": \"VanArsdel\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_VanArsdel_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Customers\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Customers.parquet\",\n            \"folderPath\": \"VanArsdel\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_VanArsdel_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"MovieActors\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_MovieActors.parquet\",\n            \"folderPath\": \"VanArsdel\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_VanArsdel_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Movies\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Movies.parquet\",\n            \"folderPath\": \"VanArsdel\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_VanArsdel_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"OnlineMovieMappings\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_OnlineMovieMappings.parquet\",\n            \"folderPath\": \"VanArsdel\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_VanArsdel_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"dbo\",\n            \"table\": \"Transactions\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"dbo_Transactions.parquet\",\n            \"folderPath\": \"VanArsdel\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_VanArsdel_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\nINSERT INTO [dbo].[ControlTable] \n(\n    [SourceObjectSettings],\n    [SourceConnectionSettingsName],\n    [CopySourceSettings],\n    [SinkObjectSettings],\n    [SinkConnectionSettingsName],\n    [CopySinkSettings],\n    [CopyActivitySettings],\n    [TopLevelPipelineName],\n    [TriggerName],\n    [DataLoadingBehaviorSettings],\n    [TaskId],\n    [CopyEnabled]\n)\nSELECT * \nFROM OPENJSON(@MainControlMetadata)\nWITH \n(\n    [SourceObjectSettings] [nvarchar](max) AS JSON,\n    [SourceConnectionSettingsName] [varchar](max),\n    [CopySourceSettings] [nvarchar](max) AS JSON,\n    [SinkObjectSettings] [nvarchar](max) AS JSON,\n    [SinkConnectionSettingsName] [varchar](max),\n    [CopySinkSettings] [nvarchar](max) AS JSON,\n    [CopyActivitySettings] [nvarchar](max) AS JSON,\n    [TopLevelPipelineName] [varchar](max),\n    [TriggerName] [nvarchar](max) AS JSON,\n    [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n    [TaskId] [int],\n    [CopyEnabled] [bit]\n)\n\nSET @MainControlMetadata = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"fileName\": null,\n            \"folderPath\": \"Rentals\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": null,\n            \"folderPath\": \"FourthCoffee/Rentals\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"recursive\": true,\n            \"wildcardFileName\": \"*\"\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null,\n            \"enableSkipIncompatibleRow\": false,\n            \"skipErrorFile\": {\n                \"fileMissing\": true\n            }\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_FourthCoffee_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"fileName\": null,\n            \"folderPath\": \"Transactions_2018\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": null,\n            \"folderPath\": \"FourthCoffee/Transactions_2018\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"recursive\": true,\n            \"wildcardFileName\": \"*\"\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null,\n            \"enableSkipIncompatibleRow\": false,\n            \"skipErrorFile\": {\n                \"fileMissing\": true\n            }\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_FourthCoffee_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\nINSERT INTO [dbo].[ControlTable] \n(\n    [SourceObjectSettings],\n    [SourceConnectionSettingsName],\n    [CopySourceSettings],\n    [SinkObjectSettings],\n    [SinkConnectionSettingsName],\n    [CopySinkSettings],\n    [CopyActivitySettings],\n    [TopLevelPipelineName],\n    [TriggerName],\n    [DataLoadingBehaviorSettings],\n    [TaskId],\n    [CopyEnabled]\n)\nSELECT * \nFROM OPENJSON(@MainControlMetadata)\nWITH \n(\n    [SourceObjectSettings] [nvarchar](max) AS JSON,\n    [SourceConnectionSettingsName] [varchar](max),\n    [CopySourceSettings] [nvarchar](max) AS JSON,\n    [SinkObjectSettings] [nvarchar](max) AS JSON,\n    [SinkConnectionSettingsName] [varchar](max),\n    [CopySinkSettings] [nvarchar](max) AS JSON,\n    [CopyActivitySettings] [nvarchar](max) AS JSON,\n    [TopLevelPipelineName] [varchar](max),\n    [TriggerName] [nvarchar](max) AS JSON,\n    [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n    [TaskId] [int],\n    [CopyEnabled] [bit]\n)\n\nSET @MainControlMetadata = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"Address\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.Address.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.Address\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"Customer\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.Customer.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.Customer\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"CustomerAddress\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.CustomerAddress.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.CustomerAddress\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"Product\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.Product.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.Product\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"ProductCategory\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.ProductCategory.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.ProductCategory\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"ProductDescription\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.ProductDescription.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.ProductDescription\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"ProductModel\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.ProductModel.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.ProductModel\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"ProductModelProductDescription\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.ProductModelProductDescription.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.ProductModelProductDescription\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"SalesOrderDetail\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.SalesOrderDetail.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.SalesOrderDetail\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    },\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"SalesLT\",\n            \"table\": \"SalesOrderHeader\"\n        },\n        \"SinkObjectSettings\": {\n            \"fileName\": \"SalesLT.SalesOrderHeader.parquet\",\n            \"folderPath\": \"AdventureWorksLT\",\n            \"fileSystem\": \"bronze\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": \"select * from SalesLT.SalesOrderHeader\",\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": null\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_AdventureWorks_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"FullLoad\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\nINSERT INTO [dbo].[ControlTable] \n(\n    [SourceObjectSettings],\n    [SourceConnectionSettingsName],\n    [CopySourceSettings],\n    [SinkObjectSettings],\n    [SinkConnectionSettingsName],\n    [CopySinkSettings],\n    [CopyActivitySettings],\n    [TopLevelPipelineName],\n    [TriggerName],\n    [DataLoadingBehaviorSettings],\n    [TaskId],\n    [CopyEnabled]\n)\nSELECT * \nFROM OPENJSON(@MainControlMetadata)\nWITH \n(\n    [SourceObjectSettings] [nvarchar](max) AS JSON,\n    [SourceConnectionSettingsName] [varchar](max),\n    [CopySourceSettings] [nvarchar](max) AS JSON,\n    [SinkObjectSettings] [nvarchar](max) AS JSON,\n    [SinkConnectionSettingsName] [varchar](max),\n    [CopySinkSettings] [nvarchar](max) AS JSON,\n    [CopyActivitySettings] [nvarchar](max) AS JSON,\n    [TopLevelPipelineName] [varchar](max),\n    [TriggerName] [nvarchar](max) AS JSON,\n    [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n    [TaskId] [int],\n    [CopyEnabled] [bit]\n)",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "Metadatabase",
				"poolName": "Metadatabase"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}